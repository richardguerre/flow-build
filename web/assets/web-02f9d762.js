import{c as d,j as n,ai as k}from"./index-e40f1048.js";import{d as b}from"./index-d3fc9829.js";const y=b(t=>{const i=t.React,u=t.components,x=()=>{var p,v;const a=t.operations.useLazyQuery({pluginSlug:t.pluginSlug,operationName:"calendars"}),c=new Set(((p=a==null?void 0:a.data)==null?void 0:p.flatMap(e=>e.calendars).filter(e=>e.connected&&!!e.id).map(e=>e.id))??[]),[s,l]=i.useState(c),[r,m]=t.hooks.useDebounce(s,1e3),[g,h]=i.useState(!1),C=e=>{s.has(e)?s.delete(e):s.add(e),l(new Set(s))};t.hooks.useAsyncEffect(async()=>{r.size===c.size&&Array.from(r).every(e=>c.has(e))||(h(!0),await t.operations.mutation({pluginSlug:t.pluginSlug,operationName:"connectCalendars",input:{calendarIds:Array.from(r)}}),h(!1))},[r]);let o="Saved";return m&&!g?o="Not saved yet...":!m&&g?o="Saving...":o="Saved",d("div",{className:"flex flex-col gap-2",children:[(v=a==null?void 0:a.data)==null?void 0:v.map(e=>d("div",{className:"flex flex-col gap-2 rounded w-full bg-background-50 shadow px-4 py-2",children:[n("div",{className:"font-semibold",children:e.account}),n("div",{className:"flex flex-col gap-2",children:e.calendars.map(f=>n(u.CheckboxWithLabel,{label:f.summary??"Unknown calendar",checked:s.has(f.id),onCheckedChange:()=>C(f.id)}))})]})),n("div",{className:"italic text-sm text-foreground-700",children:o})]})};return{name:"Google Calendar",settings:{"connect-account":{type:"custom",render:()=>d("div",{className:"flex flex-col gap-2",children:[n("a",{href:`${t.serverOrigin}/api/plugin/google-calendar/auth`,children:n(u.Button,{children:"Connect an account"})}),n(u.ErrorBoundary,{fallbackRender:({error:a})=>{var c,s,l;return((l=(s=(c=a.cause)==null?void 0:c[0])==null?void 0:s.extensions)==null?void 0:l.code)==="NOT_AUTHENTICATED"?n(k,{}):n("p",{className:"text-sm text-negative-600",children:a.message})},children:n(i.Suspense,{fallback:"Loading connected accounts...",children:n(x,{})})})]})}},routineSteps:{"create-tasks-from-events":{name:"Create tasks from events",description:"Create tasks from events in your connected Google Calendars.",component:a=>n("div",{children:d("div",{children:[n(a.BackButton,{}),n(a.NextButton,{})]})})}}}});export{y as default};
