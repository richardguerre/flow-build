import{u as P,j as e,r as V,i as w,h,b as t,P as g,B as b,Q as N,k as y}from"./index-7daf0cae.js";import{u as x,F as p}from"./FormInput-b9efab16.js";const k=function(){var a=[{alias:null,args:null,kind:"ScalarField",name:"isPasswordSet",storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"LoginViewQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"LoginViewQuery",selections:a},params:{cacheID:"c86ca9545d3cc36aae54456b94093b6d",id:null,metadata:{},name:"LoginViewQuery",operationKind:"query",text:`query LoginViewQuery {
  isPasswordSet
}
`}}}();k.hash="987de719a37976c3eb8816d3c8401934";const L=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],n=[{alias:"token",args:[{kind:"Variable",name:"input",variableName:"input"}],kind:"ScalarField",name:"login",storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"LoginViewLoginMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"LoginViewLoginMutation",selections:n},params:{cacheID:"738d0d10c797d9ce46a7ab3069eaf5f2",id:null,metadata:{},name:"LoginViewLoginMutation",operationKind:"mutation",text:`mutation LoginViewLoginMutation(
  $input: MutationLoginInput!
) {
  token: login(input: $input)
}
`}}}();L.hash="15e201db0c055adbb6ccd570fc56a855";const S=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],n=[{alias:"token",args:[{kind:"Variable",name:"input",variableName:"input"}],kind:"ScalarField",name:"setPassword",storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"LoginViewSetPasswordMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"LoginViewSetPasswordMutation",selections:n},params:{cacheID:"12ca3c89aaa4d177a2a6186620d99cf9",id:null,metadata:{},name:"LoginViewSetPasswordMutation",operationKind:"mutation",text:`mutation LoginViewSetPasswordMutation(
  $input: MutationSetPasswordInput!
) {
  token: setPassword(input: $input)
}
`}}}();S.hash="9627ff724c6ef31d42a87331ca1a44e0";const v=k,D=()=>{const{queryRef:a}=P(v);return a?e(F,{queryRef:a}):null},F=a=>V.usePreloadedQuery(v,a.queryRef).isPasswordSet?e(I,{}):e(M,{}),I=()=>{const a=w(),{register:n,handleSubmit:o,formState:s,setError:i}=x(),[l,d]=h(L);return e("div",{className:"flex h-screen items-center justify-center",children:t("div",{className:"bg-background-50 flex max-w-md flex-col gap-8 rounded-lg p-16",children:[e("h1",{className:"text-center text-3xl font-semibold",children:"Welcome back!"}),t("form",{onSubmit:o(u=>{l({variables:{input:{password:u.password}},onError:r=>i("password",{message:r.message}),onCompleted:r=>{window.localStorage.setItem(y,r.token),a("/")}})}),className:"flex flex-col gap-4",children:[t("div",{className:"flex flex-col gap-2",children:[e("p",{children:"Your Flow has been protected. Please input your password."}),e(p,{leftIcon:e(g,{}),type:"password",placeholder:"Password",fullWidth:!0,...n("password",{required:"Please enter your password.",minLength:{value:8,message:"Your password must be at least 8 characters long."}}),error:s.errors.password})]}),e(b,{fullWidth:!0,loading:d,children:"Login"})]})]})})},M=()=>{const a=w(),{register:n,handleSubmit:o,formState:s,setError:i,watch:l}=x(),d=l("password"),[f,u]=h(S);return e("div",{className:"flex h-screen items-center justify-center",children:t("div",{className:"bg-background-50 flex max-w-md flex-col gap-8 rounded-lg p-16",children:[e("h1",{className:"text-center text-3xl font-semibold",children:"Welcome to your Flow"}),t("form",{onSubmit:o(c=>{f({variables:{input:{password:c.password}},onError:m=>i("root",{message:m.message}),onCompleted:m=>{window.localStorage.setItem(y,m.token),a("/")}})}),className:"flex flex-col gap-4",children:[t("div",{className:"flex flex-col gap-2",children:[e("p",{children:"First, let's protect your Flow from others by setting a password."}),e(p,{leftIcon:e(g,{}),type:"password",placeholder:"Password",fullWidth:!0,...n("password",{required:"Please enter your password."}),error:s.errors.password,hasError:!!s.errors.confirmPassword}),e(p,{leftIcon:e(g,{}),type:"password",placeholder:"Confirm password",fullWidth:!0,...n("confirmPassword",{required:"Please confirm your password.",minLength:{value:8,message:"Your password must be at least 8 characters long."},validate:c=>c===d||"Passwords do not match."}),error:s.errors.confirmPassword}),t("div",{className:"text-foreground-700 bg-primary-50 flex gap-2 rounded p-2",children:[e(N,{className:"flex-shrink-0"}),e("p",{className:"text-sm",children:"Psst... make sure to save it somewhere safe, like a password manager."})]})]}),e(b,{fullWidth:!0,loading:u,children:"Set password"})]})]})})};export{D as default};
