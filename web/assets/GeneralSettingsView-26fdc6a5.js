import{b as u,j as n,h as w,B as m,i as k,a as S,n as b,k as i}from"./index-c866acf4.js";import{u as C,F as d}from"./FormInput-7b0a017f.js";const p=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:"newToken",args:[{kind:"Variable",name:"input",variableName:"input"}],kind:"ScalarField",name:"changePassword",storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"GeneralSettingsViewChangePasswordMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"GeneralSettingsViewChangePasswordMutation",selections:a},params:{cacheID:"6fa91b38968cfe09504f4f102ec432ce",id:null,metadata:{},name:"GeneralSettingsViewChangePasswordMutation",operationKind:"mutation",text:`mutation GeneralSettingsViewChangePasswordMutation(
  $input: MutationChangePasswordInput!
) {
  newToken: changePassword(input: $input)
}
`}}}();p.hash="10003f56ffad278cf6521eb39ce5b69f";const f=function(){var e=[{alias:null,args:null,kind:"ScalarField",name:"logout",storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"GeneralSettingsViewLogoutMutation",selections:e,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"GeneralSettingsViewLogoutMutation",selections:e},params:{cacheID:"1ac28a93faab21c06a11e063ca1de59e",id:null,metadata:{},name:"GeneralSettingsViewLogoutMutation",operationKind:"mutation",text:`mutation GeneralSettingsViewLogoutMutation {
  logout
}
`}}}();f.hash="6b42c965d968abafa0d1352a793751e6";const L=()=>u("div",{className:"flex flex-col gap-8 p-8",children:[n(v,{}),n(y,{})]}),v=()=>{const[e,a]=w(p),{register:o,handleSubmit:l,formState:t,setError:c,reset:s}=C(),h=g=>{e({variables:{input:{oldPassword:g.oldPassword,newPassword:g.newPassword}},onError:r=>c("newPasswordConfirm",{message:r.message}),onCompleted:r=>{b.success("Password changed successfully.");const P=window.localStorage.getItem(i);console.info(`${P} is no longer valid.`),console.info(`New token: ${r.newToken}`),window.localStorage.setItem(i,r.newToken),s()}})};return u("form",{className:"flex flex-col items-start gap-2",children:[n(d,{type:"password",label:"Old password",...o("oldPassword",{required:"Please enter your current password."})}),n(d,{type:"password",label:"New password",...o("newPassword",{required:"Please enter your new password."}),error:t.errors.newPassword,hasError:!!t.errors.newPasswordConfirm}),n(d,{type:"password",label:"Confirm new password",...o("newPasswordConfirm",{required:"Please confirm your new password.",minLength:{value:8,message:"Your new password must be at least 8 characters long."}}),error:t.errors.newPasswordConfirm}),n(m,{onClick:l(h),loading:a,children:"Change password"})]})},y=()=>{const e=k(),[a,o]=w(f),[l,t]=S.useState();return u("div",{className:"flex flex-col items-start gap-2",children:[n("div",{children:"Before logging out, remember to save your password so you can log back in."}),n(m,{danger:!0,onClick:()=>{a({variables:{},onError:s=>t(s.message),onCompleted:()=>{const s=window.localStorage.getItem(i);console.info(`${s} is no longer valid.`),window.localStorage.removeItem(i),e("/login")}})},loading:o,children:"Logout"}),n("div",{className:"text-negative-500 text-sm",children:l})]})};export{L as default};
